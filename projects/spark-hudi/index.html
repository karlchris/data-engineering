
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="All you need to know about Data Engineering, Data Warehousing and Data Platform.">
      
      
        <meta name="author" content="Karl Christian">
      
      
        <link rel="canonical" href="https://karlchris.github.io/data-engineering/projects/spark-hudi/">
      
      
        <link rel="prev" href="../delta-spark/">
      
      
        <link rel="next" href="../duckdb-quickstart/">
      
      
      <link rel="icon" href="../../assets/img/sqldeveloper-original.svg">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.24">
    
    
      
        <title>Apache Hudi and Spark - Data Engineering Works</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      

  
  
  
  
  <style>:root{--md-annotation-icon:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 13h-4v4h-2v-4H7v-2h4V7h2v4h4m-5-9A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2Z"/></svg>');}</style>


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Sans:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Fira Sans";--md-code-font:"Fira Code"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#apache-hudi-and-spark" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Data Engineering Works" class="md-header__button md-logo" aria-label="Data Engineering Works" data-md-component="logo">
      
  <img src="../../assets/img/sqldeveloper-original.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Data Engineering Works
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Apache Hudi and Spark
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/karlchris/data-engineering" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    karlchris/data-engineering
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
    
  
  Projects

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../data-engineering/" class="md-tabs__link">
          
  
    
  
  Data Engineering

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../data-modeling/" class="md-tabs__link">
          
  
    
  
  Data Modeling

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../data-ingestion/" class="md-tabs__link">
          
  
    
  
  Data Ingestion

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../data-architecture/" class="md-tabs__link">
          
  
    
  
  Data Architecture

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../data-orchestration/" class="md-tabs__link">
          
  
    
  
  Data Orchestration

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../data-processing/" class="md-tabs__link">
          
  
    
  
  Data Processing

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../data-quality/" class="md-tabs__link">
          
  
    
  
  Data Quality

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../learning-python/" class="md-tabs__link">
          
  
    
  
  Python

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../author/" class="md-tabs__link">
        
  
    
  
  About me

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Data Engineering Works" class="md-nav__button md-logo" aria-label="Data Engineering Works" data-md-component="logo">
      
  <img src="../../assets/img/sqldeveloper-original.svg" alt="logo">

    </a>
    Data Engineering Works
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/karlchris/data-engineering" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    karlchris/data-engineering
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Projects
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Projects
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dbt-bq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Running dbt and BigQuery using Docker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../great-expectations-bq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Automated Data Quality Testing with Great Expectations and BigQuery
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../airflow-k8s/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deploying and Running Airflow on Kubernetes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gh-pages-gh-actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building Github Pages using Github Actions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../flink-k8s/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Running Apache Flink on Kubernetes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spark-docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Running Spark using Docker Compose
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kafka-ksql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Querying Streaming Data in Kafka using ksql
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spark-iceberg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Apache Iceberg and PySpark
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../delta-spark/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Delta Lake with Apache Spark
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Apache Hudi and Spark
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Apache Hudi and Spark
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-hudi" class="md-nav__link">
    <span class="md-ellipsis">
      What is Hudi
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hudi-stack" class="md-nav__link">
    <span class="md-ellipsis">
      Hudi Stack
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hudi Stack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lake-storage" class="md-nav__link">
    <span class="md-ellipsis">
      Lake Storage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-formats" class="md-nav__link">
    <span class="md-ellipsis">
      File Formats
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transactional-database-layer" class="md-nav__link">
    <span class="md-ellipsis">
      Transactional Database Layer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Transactional Database Layer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#table-format" class="md-nav__link">
    <span class="md-ellipsis">
      Table Format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#indexes" class="md-nav__link">
    <span class="md-ellipsis">
      Indexes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#table-services" class="md-nav__link">
    <span class="md-ellipsis">
      Table Services
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Implementation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quickstart" class="md-nav__link">
    <span class="md-ellipsis">
      Quickstart
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installing-hudi-package" class="md-nav__link">
    <span class="md-ellipsis">
      Installing Hudi Package
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-hudi-table-and-insert-data" class="md-nav__link">
    <span class="md-ellipsis">
      Create Hudi Table and Insert Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#query-data" class="md-nav__link">
    <span class="md-ellipsis">
      Query data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-data" class="md-nav__link">
    <span class="md-ellipsis">
      Update data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-data" class="md-nav__link">
    <span class="md-ellipsis">
      Delete data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#incremental-query" class="md-nav__link">
    <span class="md-ellipsis">
      Incremental Query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change-data-capture-query" class="md-nav__link">
    <span class="md-ellipsis">
      Change Data Capture Query
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../duckdb-quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DuckDB Quick Start using Jupyter Notebook
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../data-engineering/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Data Engineering
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Data Engineering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-engineering/ingestion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ingestion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-engineering/transformation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transformation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-engineering/visualization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Visualization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-engineering/storage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-engineering/dataops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DataOps/Security/Infrastructure
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
          
        
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../data-modeling/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Data Modeling
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Data Modeling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../data-modeling/dimensional-modeling/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Dimensional Modeling
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Dimensional Modeling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-modeling/dimensional-modeling/challenge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Challenge
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-modeling/ddl-vs-dml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DDL vs. DML
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-modeling/query-lifecycle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Query Life Cycle
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../data-ingestion/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Data Ingestion
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Data Ingestion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-ingestion/batch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Batch Ingestion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-ingestion/streaming/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Streaming Ingestion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-ingestion/push-pull/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Push vs. Pull
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Methods
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            Methods
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-ingestion/methods/sftp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secure File Transfer Protocol (SFTP)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-ingestion/methods/api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Application Programming Interface (API)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-ingestion/methods/object-storage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Object Storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-ingestion/methods/cdc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Change Data Capture (CDC)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-ingestion/methods/streaming-platform/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Streaming Platform
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../data-architecture/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Data Architecture
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Data Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-architecture/framework-architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Framework Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-architecture/storage-architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Storage Architecture
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../data-orchestration/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Data Orchestration
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Data Orchestration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../data-orchestration/airflow/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Airflow
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            Airflow
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-orchestration/airflow/airflow-dag-design/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Airflow DAG Design
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-orchestration/dbt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Build Tool (dbt)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../data-processing/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Data Processing
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8" id="__nav_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Data Processing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../data-processing/apache-spark/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Apache Spark
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8_2" id="__nav_8_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            Apache Spark
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-processing/apache-spark/spark-optimization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spark Optimizations
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../data-processing/bigquery/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Google BigQuery
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_3">
            <span class="md-nav__icon md-icon"></span>
            Google BigQuery
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../data-quality/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Data Quality
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9" id="__nav_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Data Quality
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-quality/dbt-test/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dbt test
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
          
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../learning-python/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Python
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_10" id="__nav_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../learning-python/oop/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Object Oriented Programming
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_10_2" id="__nav_10_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_2">
            <span class="md-nav__icon md-icon"></span>
            Object Oriented Programming
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../learning-python/oop/class/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Class
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../learning-python/oop/encapsulation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Encapsulation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../learning-python/oop/inheritance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inheritance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../learning-python/oop/polymorphism/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Polymorphism
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../learning-python/oop/object-relationship/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Object Relationship
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../learning-python/functional-programming/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functional Programming
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../learning-python/unit-testing/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Unit Testing
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_10_4" id="__nav_10_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_4">
            <span class="md-nav__icon md-icon"></span>
            Unit Testing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../learning-python/unit-testing/assertion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Assertion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../learning-python/unit-testing/exceptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exceptions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../learning-python/unit-testing/fixtures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fixtures
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../learning-python/unit-testing/decorator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Decorator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../learning-python/unit-testing/parametrizing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parametrizing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../learning-python/unit-testing/mocking/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mocking
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../learning-python/scaling-python/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Scaling Python
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_10_5" id="__nav_10_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_5">
            <span class="md-nav__icon md-icon"></span>
            Scaling Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../learning-python/scaling-python/cpu-scaling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CPU Scaling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../learning-python/scaling-python/async-solution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Asynchronous Events
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../learning-python/scaling-python/queue-distribution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Queue-based Distribution
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../author/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About me
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-hudi" class="md-nav__link">
    <span class="md-ellipsis">
      What is Hudi
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hudi-stack" class="md-nav__link">
    <span class="md-ellipsis">
      Hudi Stack
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hudi Stack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lake-storage" class="md-nav__link">
    <span class="md-ellipsis">
      Lake Storage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-formats" class="md-nav__link">
    <span class="md-ellipsis">
      File Formats
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transactional-database-layer" class="md-nav__link">
    <span class="md-ellipsis">
      Transactional Database Layer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Transactional Database Layer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#table-format" class="md-nav__link">
    <span class="md-ellipsis">
      Table Format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#indexes" class="md-nav__link">
    <span class="md-ellipsis">
      Indexes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#table-services" class="md-nav__link">
    <span class="md-ellipsis">
      Table Services
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Implementation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quickstart" class="md-nav__link">
    <span class="md-ellipsis">
      Quickstart
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installing-hudi-package" class="md-nav__link">
    <span class="md-ellipsis">
      Installing Hudi Package
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-hudi-table-and-insert-data" class="md-nav__link">
    <span class="md-ellipsis">
      Create Hudi Table and Insert Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#query-data" class="md-nav__link">
    <span class="md-ellipsis">
      Query data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-data" class="md-nav__link">
    <span class="md-ellipsis">
      Update data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-data" class="md-nav__link">
    <span class="md-ellipsis">
      Delete data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#incremental-query" class="md-nav__link">
    <span class="md-ellipsis">
      Incremental Query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change-data-capture-query" class="md-nav__link">
    <span class="md-ellipsis">
      Change Data Capture Query
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/karlchris/data-engineering/edit/master/docs/projects/spark-hudi.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/karlchris/data-engineering/raw/master/docs/projects/spark-hudi.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5Z"/></svg>
    </a>
  


<h1 id="apache-hudi-and-spark">Apache Hudi and Spark<a class="headerlink" href="#apache-hudi-and-spark" title="Permanent link">#</a></h1>
<p><img alt="spark-hudi" src="../pics/spark-hudi.png" /></p>
<h2 id="what-is-hudi">What is Hudi<a class="headerlink" href="#what-is-hudi" title="Permanent link">#</a></h2>
<p><strong>Apache Hudi</strong> is a transactional data lake platform that brings database and data warehouse capabilities to the data lake.
Hudi reimagines slow old-school batch data processing with a powerful new incremental processing framework for low latency minute-level analytics.</p>
<p><img alt="hudi-integrations" src="../pics/hudi-integrations.png" /></p>
<h2 id="hudi-stack">Hudi Stack<a class="headerlink" href="#hudi-stack" title="Permanent link">#</a></h2>
<p><img alt="hudi-stack" src="../pics/hudi-stack.png" /></p>
<ul>
<li>Apache Hudi is a Transactional Data Lakehouse Platform built around a database kernel.</li>
<li>It brings core warehouse and database functionality directly to a data lake thereby providing a table-level abstraction over open file formats like Apache Parquet/ORC (more recently known as the lakehouse architecture) and enabling transactional capabilities such as updates/deletes.</li>
<li>Hudi also incorporates essential table services that are tightly integrated with the database kernel.</li>
<li>These services can be executed automatically across both ingested and derived data to manage various aspects such as table bookkeeping, metadata, and storage layout.</li>
<li>This integration along with various platform-specific services extends Hudi's role from being just a 'table format' to a comprehensive and robust data lakehouse platform.</li>
</ul>
<h3 id="lake-storage">Lake Storage<a class="headerlink" href="#lake-storage" title="Permanent link">#</a></h3>
<p>The storage layer is where the data files (such as Parquet) are stored. Hudi interacts with the storage layer through the Hadoop FileSystem API, enabling compatibility with various systems including HDFS for fast appends, and various cloud stores such as Amazon S3, Google Cloud Storage (GCS), and Azure Blob Storage.</p>
<p>Additionally, Hudi offers its own storage APIs that can rely on Hadoop-independent file system implementation to simplify the integration of various file systems.</p>
<h3 id="file-formats">File Formats<a class="headerlink" href="#file-formats" title="Permanent link">#</a></h3>
<p><img alt="hudi-file-formats" src="../pics/hudi-file-formats.png" /></p>
<ul>
<li>File formats hold the raw data and are <strong>physically</strong> stored on the lake storage.</li>
<li>Hudi operates on logical structures of <strong>File Groups</strong> and <strong>File Slices</strong>, which consist of <strong>Base File</strong> and <strong>Log Files</strong>.</li>
<li>Base Files are <strong>compacted</strong> and <strong>optimized for reads</strong> and are augmented with <strong>Log Files</strong> for efficient append.</li>
</ul>
<p><img alt="hudi-files-view" src="../pics/hudi-files-view.png" /></p>
<h2 id="transactional-database-layer">Transactional Database Layer<a class="headerlink" href="#transactional-database-layer" title="Permanent link">#</a></h2>
<p>The transactional database layer of Hudi comprises the core components that are responsible for the fundamental operations and services that enable Hudi to store, retrieve, and manage data efficiently on data lakehouse storages.</p>
<h3 id="table-format">Table Format<a class="headerlink" href="#table-format" title="Permanent link">#</a></h3>
<p><img alt="hudi-table-format" src="../pics/hudi-table-format.png" /></p>
<p>There are 3 major components related to Hudi’s table format:</p>
<ul>
<li><strong>Timeline</strong></li>
</ul>
<p>Hudi's timeline, stored in the /.hoodie folder, is a crucial event log recording all table actions in an ordered manner, with events kept for a specified period.
Hudi uniquely designs each File Group as a self-contained log, enabling record state reconstruction through delta logs, even after archival of related actions.</p>
<ul>
<li><strong>File Group and File Slice</strong></li>
</ul>
<p>Within each partition the data is physically stored as base and Log Files and organized into logical concepts as File groups and File Slices.
File groups contain multiple versions of File Slices and are split into multiple File Slices. A File Slice comprises the Base and Log File.
Each File Slice within the file-group is uniquely identified by the commit's timestamp that created it.</p>
<ul>
<li><strong>Metadata Table</strong></li>
</ul>
<p>Implemented as a merge-on-read table, Hudi's metadata table efficiently handles quick updates with low write amplification.
It leverages the HFile format for quick, indexed key lookups, storing vital information like file paths, column statistics, bloom filters, and record indexes.</p>
<div class="admonition tips">
<p class="admonition-title">Tips</p>
<p>Hudi’s approach of recording updates into Log Files is more efficient and involves low merge overhead than systems like Hive ACID, where merging all delta records against all Base Files is required.</p>
</div>
<h3 id="indexes">Indexes<a class="headerlink" href="#indexes" title="Permanent link">#</a></h3>
<p><img alt="hudi-indexes" src="../pics/hudi-indexes.png" /></p>
<ul>
<li>Indexes in Hudi enhance query planning, minimizing I/O, speeding up response times and providing faster writes with low merge costs.</li>
<li>Hudi’s metadata table brings the benefits of indexes generally to both the readers and writers.</li>
<li>Compute engines can leverage various indexes in the metadata table, like file listings, column statistics, bloom filters, record-level indexes, and functional indexes to quickly generate optimized query plans and improve read performance.</li>
</ul>
<h3 id="table-services">Table Services<a class="headerlink" href="#table-services" title="Permanent link">#</a></h3>
<p><img alt="hudi-table-services" src="../pics/hudi-table-services.png" /></p>
<ul>
<li>Apache Hudi offers various table services to help keep the table storage layout and metadata management performant.</li>
<li>Hudi was designed with built-in table services that enables running them in inline, semi-asynchronous or full-asynchronous modes.</li>
<li>Furthermore, Spark and Flink streaming writers can run in continuous mode, and invoke table services asynchronously sharing the underlying executors intelligently with writers.</li>
</ul>
<h2 id="implementation">Implementation<a class="headerlink" href="#implementation" title="Permanent link">#</a></h2>
<p>Let's take a look into executing Hudi spark code.</p>
<p>First, you need to clone this repo.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>git<span class="w"> </span>clone<span class="w"> </span>git@github.com:karlchris/spark-docker.git
</span></code></pre></div>
<h3 id="quickstart">Quickstart<a class="headerlink" href="#quickstart" title="Permanent link">#</a></h3>
<ul>
<li>run below command to execute docker compose</li>
</ul>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>make<span class="w"> </span>up
</span></code></pre></div>
<ul>
<li>enter into the container</li>
</ul>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>make<span class="w"> </span>dev
</span></code></pre></div>
<ul>
<li>execute the code</li>
</ul>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>./bin/spark-submit<span class="w"> </span>scripts/hudi-demo.py
</span></code></pre></div>
<ul>
<li>remove the running containers</li>
</ul>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>make<span class="w"> </span>down
</span></code></pre></div>
<h3 id="installing-hudi-package">Installing Hudi Package<a class="headerlink" href="#installing-hudi-package" title="Permanent link">#</a></h3>
<ul>
<li>add this to the Dockerfile</li>
</ul>
<div class="language-Dockerfile highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c"># Download hudi jars</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="k">RUN</span><span class="w"> </span>curl<span class="w"> </span>https://repo1.maven.org/maven2/org/apache/hudi/hudi-spark3-bundle_2.12/0.15.0/hudi-spark3-bundle_2.12-0.15.0.jar<span class="w"> </span>-Lo<span class="w"> </span>/opt/spark/jars/hudi-spark3-bundle_2.12-0.15.0.jar
</span></code></pre></div>
<ul>
<li>Setup Hudi in spark session</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">SparkSession</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="kn">from</span> <span class="nn">pyspark</span> <span class="kn">import</span> <span class="n">SparkConf</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="kn">from</span> <span class="nn">pyspark.sql.functions</span> <span class="kn">import</span> <span class="n">col</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="n">jars</span> <span class="o">=</span> <span class="s1">&#39;org.apache.hudi:hudi-spark3-bundle_2.12:0.15.0&#39;</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="c1"># Setup config</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="n">conf</span> <span class="o">=</span> <span class="n">SparkConf</span><span class="p">()</span><span class="o">.</span><span class="n">setAppName</span><span class="p">(</span><span class="s2">&quot;hudiDemo&quot;</span><span class="p">)</span> \
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>    <span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;spark.sql.extensions&quot;</span><span class="p">,</span> <span class="s2">&quot;org.apache.spark.sql.hudi.HoodieSparkSessionExtension&quot;</span><span class="p">)</span> \
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>    <span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;spark.sql.catalog.spark_catalog&quot;</span><span class="p">,</span> <span class="s2">&quot;org.apache.spark.sql.hudi.catalog.HoodieCatalog&quot;</span><span class="p">)</span> \
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>    <span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;spark.serializer&quot;</span><span class="p">,</span> <span class="s2">&quot;org.apache.spark.serializer.KryoSerializer&quot;</span><span class="p">)</span> \
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>    <span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;spark.kryo.registrator&quot;</span><span class="p">,</span> <span class="s2">&quot;org.apache.spark.HoodieSparkKryoRegistrar&quot;</span><span class="p">)</span> \
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>    <span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;spark.jars.packages&#39;</span><span class="p">,</span> <span class="n">jars</span><span class="p">)</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="c1"># Create spark session</span>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">conf</span><span class="o">=</span><span class="n">conf</span><span class="p">)</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="n">spark</span><span class="o">.</span><span class="n">sparkContext</span><span class="o">.</span><span class="n">setLogLevel</span><span class="p">(</span><span class="s2">&quot;ERROR&quot;</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="create-hudi-table-and-insert-data">Create Hudi Table and Insert Data<a class="headerlink" href="#create-hudi-table-and-insert-data" title="Permanent link">#</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1"># Path</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="n">HOME</span> <span class="o">=</span> <span class="s2">&quot;/opt/spark/&quot;</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="c1"># Create table</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="n">tableName</span> <span class="o">=</span> <span class="s2">&quot;trips_table&quot;</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="n">basePath</span> <span class="o">=</span> <span class="n">HOME</span> <span class="o">+</span> <span class="s2">&quot;warehouse/hudi/trips_table&quot;</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating table </span><span class="si">{</span><span class="n">tableName</span><span class="si">}</span><span class="s2"> at </span><span class="si">{</span><span class="n">basePath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="c1"># Insert data</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Inserting data&quot;</span><span class="p">)</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ts&quot;</span><span class="p">,</span><span class="s2">&quot;uuid&quot;</span><span class="p">,</span><span class="s2">&quot;rider&quot;</span><span class="p">,</span><span class="s2">&quot;driver&quot;</span><span class="p">,</span><span class="s2">&quot;fare&quot;</span><span class="p">,</span><span class="s2">&quot;city&quot;</span><span class="p">]</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="n">data</span> <span class="o">=</span><span class="p">[(</span><span class="mi">1695159649087</span><span class="p">,</span><span class="s2">&quot;334e26e9-8355-45cc-97c6-c31daf0df330&quot;</span><span class="p">,</span><span class="s2">&quot;rider-A&quot;</span><span class="p">,</span><span class="s2">&quot;driver-K&quot;</span><span class="p">,</span><span class="mf">19.10</span><span class="p">,</span><span class="s2">&quot;san_francisco&quot;</span><span class="p">),</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>    <span class="p">(</span><span class="mi">1695091554788</span><span class="p">,</span><span class="s2">&quot;e96c4396-3fad-413a-a942-4cb36106d721&quot;</span><span class="p">,</span><span class="s2">&quot;rider-C&quot;</span><span class="p">,</span><span class="s2">&quot;driver-M&quot;</span><span class="p">,</span><span class="mf">27.70</span> <span class="p">,</span><span class="s2">&quot;san_francisco&quot;</span><span class="p">),</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>    <span class="p">(</span><span class="mi">1695046462179</span><span class="p">,</span><span class="s2">&quot;9909a8b1-2d15-4d3d-8ec9-efc48c536a00&quot;</span><span class="p">,</span><span class="s2">&quot;rider-D&quot;</span><span class="p">,</span><span class="s2">&quot;driver-L&quot;</span><span class="p">,</span><span class="mf">33.90</span> <span class="p">,</span><span class="s2">&quot;san_francisco&quot;</span><span class="p">),</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>    <span class="p">(</span><span class="mi">1695516137016</span><span class="p">,</span><span class="s2">&quot;e3cf430c-889d-4015-bc98-59bdce1e530c&quot;</span><span class="p">,</span><span class="s2">&quot;rider-F&quot;</span><span class="p">,</span><span class="s2">&quot;driver-P&quot;</span><span class="p">,</span><span class="mf">34.15</span><span class="p">,</span><span class="s2">&quot;sao_paulo&quot;</span><span class="p">),</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>    <span class="p">(</span><span class="mi">1695115999911</span><span class="p">,</span><span class="s2">&quot;c8abbe79-8d89-47ea-b4ce-4d224bae5bfa&quot;</span><span class="p">,</span><span class="s2">&quot;rider-J&quot;</span><span class="p">,</span><span class="s2">&quot;driver-T&quot;</span><span class="p">,</span><span class="mf">17.85</span><span class="p">,</span><span class="s2">&quot;chennai&quot;</span><span class="p">)]</span>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="n">inserts</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">toDF</span><span class="p">(</span><span class="o">*</span><span class="n">columns</span><span class="p">)</span>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a><span class="n">hudi_options</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a>    <span class="s1">&#39;hoodie.table.name&#39;</span><span class="p">:</span> <span class="n">tableName</span><span class="p">,</span>
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a>    <span class="s1">&#39;hoodie.datasource.write.partitionpath.field&#39;</span><span class="p">:</span> <span class="s1">&#39;city&#39;</span><span class="p">,</span>
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a>    <span class="s1">&#39;hoodie.datasource.write.recordkey.field&#39;</span><span class="p">:</span> <span class="s1">&#39;uuid&#39;</span>
</span><span id="__span-7-23"><a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a><span class="p">}</span>
</span><span id="__span-7-24"><a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a>
</span><span id="__span-7-25"><a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a><span class="n">inserts</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;hudi&quot;</span><span class="p">)</span><span class="o">.</span> \
</span><span id="__span-7-26"><a id="__codelineno-7-26" name="__codelineno-7-26" href="#__codelineno-7-26"></a>    <span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">hudi_options</span><span class="p">)</span><span class="o">.</span> \
</span><span id="__span-7-27"><a id="__codelineno-7-27" name="__codelineno-7-27" href="#__codelineno-7-27"></a>    <span class="n">mode</span><span class="p">(</span><span class="s2">&quot;overwrite&quot;</span><span class="p">)</span><span class="o">.</span> \
</span><span id="__span-7-28"><a id="__codelineno-7-28" name="__codelineno-7-28" href="#__codelineno-7-28"></a>    <span class="n">save</span><span class="p">(</span><span class="n">basePath</span><span class="p">)</span>
</span></code></pre></div>
<p>It will create <code>trips_table</code> and write it within path <code>/opt/spark/warehouse/hudi/trips_table</code>.
Then, it will insert data as mentioned above.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Hudi also allows users to specify a record key, which will be used to uniquely identify a record within a Hudi table. This is useful and critical to support features like indexing and clustering, which speed up upserts and queries respectively, in a consistent manner.</p>
<p>In above example, <code>'hoodie.datasource.write.recordkey.field': 'uuid'</code> was set up.</p>
</div>
<h3 id="query-data">Query data<a class="headerlink" href="#query-data" title="Permanent link">#</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Querying data&quot;</span><span class="p">)</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="n">tripsDF</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;hudi&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">basePath</span><span class="p">)</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="n">tripsDF</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">&quot;trips_table&quot;</span><span class="p">)</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT uuid, fare, ts, rider, driver, city FROM  trips_table WHERE fare &gt; 20.0&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT _hoodie_commit_time, _hoodie_record_key, _hoodie_partition_path, rider, driver, fare FROM trips_table&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<p>It will query the table and get records with <code>fare more than 20</code></p>
<p>Output:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>+--------------------+-----+-------------+-------+--------+-------------+
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="p">|</span><span class="w">                </span>uuid<span class="p">|</span><span class="w"> </span>fare<span class="p">|</span><span class="w">           </span>ts<span class="p">|</span><span class="w">  </span>rider<span class="p">|</span><span class="w">  </span>driver<span class="p">|</span><span class="w">         </span>city<span class="p">|</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>+--------------------+-----+-------------+-------+--------+-------------+
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="p">|</span>e96c4396-3fad-413...<span class="p">|</span><span class="w"> </span><span class="m">27</span>.7<span class="p">|</span><span class="m">1695091554788</span><span class="p">|</span>rider-C<span class="p">|</span>driver-M<span class="p">|</span>san_francisco<span class="p">|</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="p">|</span>9909a8b1-2d15-4d3...<span class="p">|</span><span class="w"> </span><span class="m">33</span>.9<span class="p">|</span><span class="m">1695046462179</span><span class="p">|</span>rider-D<span class="p">|</span>driver-L<span class="p">|</span>san_francisco<span class="p">|</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="p">|</span>e3cf430c-889d-401...<span class="p">|</span><span class="m">34</span>.15<span class="p">|</span><span class="m">1695516137016</span><span class="p">|</span>rider-F<span class="p">|</span>driver-P<span class="p">|</span><span class="w">    </span>sao_paulo<span class="p">|</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>+--------------------+-----+-------------+-------+--------+-------------+
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>+-------------------+--------------------+----------------------+-------+--------+-----+
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="p">|</span>_hoodie_commit_time<span class="p">|</span><span class="w">  </span>_hoodie_record_key<span class="p">|</span>_hoodie_partition_path<span class="p">|</span><span class="w">  </span>rider<span class="p">|</span><span class="w">  </span>driver<span class="p">|</span><span class="w"> </span>fare<span class="p">|</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>+-------------------+--------------------+----------------------+-------+--------+-----+
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="p">|</span><span class="w">  </span><span class="m">20240705004838235</span><span class="p">|</span>334e26e9-8355-45c...<span class="p">|</span><span class="w">         </span>san_francisco<span class="p">|</span>rider-A<span class="p">|</span>driver-K<span class="p">|</span><span class="w"> </span><span class="m">19</span>.1<span class="p">|</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="p">|</span><span class="w">  </span><span class="m">20240705004838235</span><span class="p">|</span>e96c4396-3fad-413...<span class="p">|</span><span class="w">         </span>san_francisco<span class="p">|</span>rider-C<span class="p">|</span>driver-M<span class="p">|</span><span class="w"> </span><span class="m">27</span>.7<span class="p">|</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="p">|</span><span class="w">  </span><span class="m">20240705004838235</span><span class="p">|</span>9909a8b1-2d15-4d3...<span class="p">|</span><span class="w">         </span>san_francisco<span class="p">|</span>rider-D<span class="p">|</span>driver-L<span class="p">|</span><span class="w"> </span><span class="m">33</span>.9<span class="p">|</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="p">|</span><span class="w">  </span><span class="m">20240705004838235</span><span class="p">|</span>e3cf430c-889d-401...<span class="p">|</span><span class="w">             </span>sao_paulo<span class="p">|</span>rider-F<span class="p">|</span>driver-P<span class="p">|</span><span class="m">34</span>.15<span class="p">|</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="p">|</span><span class="w">  </span><span class="m">20240705004838235</span><span class="p">|</span>c8abbe79-8d89-47e...<span class="p">|</span><span class="w">               </span>chennai<span class="p">|</span>rider-J<span class="p">|</span>driver-T<span class="p">|</span><span class="m">17</span>.85<span class="p">|</span>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a>+-------------------+--------------------+----------------------+-------+--------+-----+
</span></code></pre></div>
<h3 id="update-data">Update data<a class="headerlink" href="#update-data" title="Permanent link">#</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Updating data&quot;</span><span class="p">)</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="c1"># Lets read data from target Hudi table, modify fare column for rider-D and update it.</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="n">updatesDf</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;hudi&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">basePath</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;rider == &#39;rider-D&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;fare&quot;</span><span class="p">,</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;fare&quot;</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="n">updatesDf</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;hudi&quot;</span><span class="p">)</span><span class="o">.</span> \
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>    <span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">hudi_options</span><span class="p">)</span><span class="o">.</span> \
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>    <span class="n">mode</span><span class="p">(</span><span class="s2">&quot;append&quot;</span><span class="p">)</span><span class="o">.</span> \
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>    <span class="n">save</span><span class="p">(</span><span class="n">basePath</span><span class="p">)</span>
</span></code></pre></div>
<p>It will update the <code>fare</code> column where rider is <code>rider-D</code>.</p>
<p>Output:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>+-------------------+-----+-------+--------+--------------------+-------------+
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="p">|</span>_hoodie_commit_time<span class="p">|</span><span class="w"> </span>fare<span class="p">|</span><span class="w">  </span>rider<span class="p">|</span><span class="w">  </span>driver<span class="p">|</span><span class="w">                </span>uuid<span class="p">|</span><span class="w">           </span>ts<span class="p">|</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>+-------------------+-----+-------+--------+--------------------+-------------+
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="p">|</span><span class="w">  </span><span class="m">20240705004845127</span><span class="p">|</span><span class="m">339</span>.0<span class="p">|</span>rider-D<span class="p">|</span>driver-L<span class="p">|</span>9909a8b1-2d15-4d3...<span class="p">|</span><span class="m">1695046462179</span><span class="p">|</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>+-------------------+-----+-------+--------+--------------------+-------------+
</span></code></pre></div>
<h3 id="delete-data">Delete data<a class="headerlink" href="#delete-data" title="Permanent link">#</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Deleting data&quot;</span><span class="p">)</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="n">deletesDF</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;hudi&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">basePath</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;rider == &#39;rider-F&#39;&quot;</span><span class="p">)</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="c1"># issue deletes</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="n">hudi_hard_delete_options</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>    <span class="s1">&#39;hoodie.table.name&#39;</span><span class="p">:</span> <span class="n">tableName</span><span class="p">,</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>    <span class="s1">&#39;hoodie.datasource.write.partitionpath.field&#39;</span><span class="p">:</span> <span class="s1">&#39;city&#39;</span><span class="p">,</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>    <span class="s1">&#39;hoodie.datasource.write.operation&#39;</span><span class="p">:</span> <span class="s1">&#39;delete&#39;</span><span class="p">,</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="p">}</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="n">deletesDF</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;hudi&quot;</span><span class="p">)</span><span class="o">.</span> \
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>    <span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">hudi_hard_delete_options</span><span class="p">)</span><span class="o">.</span> \
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a>    <span class="n">mode</span><span class="p">(</span><span class="s2">&quot;append&quot;</span><span class="p">)</span><span class="o">.</span> \
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a>    <span class="n">save</span><span class="p">(</span><span class="n">basePath</span><span class="p">)</span>
</span></code></pre></div>
<p>It will delete record where rider is <code>rider-F</code></p>
<h3 id="incremental-query">Incremental Query<a class="headerlink" href="#incremental-query" title="Permanent link">#</a></h3>
<p>Hudi provides the unique capability to obtain a set of records that changed between a start and end commit time, providing you with the "latest state" for each such record as of the end commit time.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>By default, Hudi tables are configured to support incremental queries, using record level metadata tracking.</p>
</div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1"># reload data</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;hudi&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">basePath</span><span class="p">)</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">&quot;trips_table&quot;</span><span class="p">)</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="n">commits</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT DISTINCT(_hoodie_commit_time) AS commitTime FROM  trips_table ORDER BY commitTime&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span><span class="p">()))</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="n">beginTime</span> <span class="o">=</span> <span class="n">commits</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">commits</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="c1"># commit time we are interested in</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Querying data incrementally from commit time: </span><span class="si">{</span><span class="n">beginTime</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="c1"># incrementally query data</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="n">incremental_read_options</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>    <span class="s1">&#39;hoodie.datasource.query.type&#39;</span><span class="p">:</span> <span class="s1">&#39;incremental&#39;</span><span class="p">,</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>    <span class="s1">&#39;hoodie.datasource.read.begin.instanttime&#39;</span><span class="p">:</span> <span class="n">beginTime</span><span class="p">,</span>
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="p">}</span>
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a>
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a><span class="n">tripsIncrementalDF</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;hudi&quot;</span><span class="p">)</span><span class="o">.</span> \
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a>    <span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">incremental_read_options</span><span class="p">)</span><span class="o">.</span> \
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a>    <span class="n">load</span><span class="p">(</span><span class="n">basePath</span><span class="p">)</span>
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a><span class="n">tripsIncrementalDF</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">&quot;trips_incremental&quot;</span><span class="p">)</span>
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a>
</span><span id="__span-13-19"><a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT `_hoodie_commit_time`, fare, rider, driver, uuid, ts FROM trips_incremental WHERE fare &gt; 20.0&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<h3 id="change-data-capture-query">Change Data Capture Query<a class="headerlink" href="#change-data-capture-query" title="Permanent link">#</a></h3>
<p>Hudi also exposes first-class support for Change Data Capture (CDC) queries.
CDC queries are useful for applications that need to obtain all the changes, along with before/after images of records, given a commit time range.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Change Data Capture Query&quot;</span><span class="p">)</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="c1"># Lets first insert data to a new table with cdc enabled.</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ts&quot;</span><span class="p">,</span><span class="s2">&quot;uuid&quot;</span><span class="p">,</span><span class="s2">&quot;rider&quot;</span><span class="p">,</span><span class="s2">&quot;driver&quot;</span><span class="p">,</span><span class="s2">&quot;fare&quot;</span><span class="p">,</span><span class="s2">&quot;city&quot;</span><span class="p">]</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="n">data</span> <span class="o">=</span><span class="p">[(</span><span class="mi">1695159649087</span><span class="p">,</span><span class="s2">&quot;334e26e9-8355-45cc-97c6-c31daf0df330&quot;</span><span class="p">,</span><span class="s2">&quot;rider-A&quot;</span><span class="p">,</span><span class="s2">&quot;driver-K&quot;</span><span class="p">,</span><span class="mf">19.10</span><span class="p">,</span><span class="s2">&quot;san_francisco&quot;</span><span class="p">),</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>    <span class="p">(</span><span class="mi">1695091554788</span><span class="p">,</span><span class="s2">&quot;e96c4396-3fad-413a-a942-4cb36106d721&quot;</span><span class="p">,</span><span class="s2">&quot;rider-B&quot;</span><span class="p">,</span><span class="s2">&quot;driver-L&quot;</span><span class="p">,</span><span class="mf">27.70</span> <span class="p">,</span><span class="s2">&quot;san_francisco&quot;</span><span class="p">),</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>    <span class="p">(</span><span class="mi">1695046462179</span><span class="p">,</span><span class="s2">&quot;9909a8b1-2d15-4d3d-8ec9-efc48c536a00&quot;</span><span class="p">,</span><span class="s2">&quot;rider-C&quot;</span><span class="p">,</span><span class="s2">&quot;driver-M&quot;</span><span class="p">,</span><span class="mf">33.90</span> <span class="p">,</span><span class="s2">&quot;san_francisco&quot;</span><span class="p">),</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>    <span class="p">(</span><span class="mi">1695516137016</span><span class="p">,</span><span class="s2">&quot;e3cf430c-889d-4015-bc98-59bdce1e530c&quot;</span><span class="p">,</span><span class="s2">&quot;rider-C&quot;</span><span class="p">,</span><span class="s2">&quot;driver-N&quot;</span><span class="p">,</span><span class="mf">34.15</span><span class="p">,</span><span class="s2">&quot;sao_paulo&quot;</span><span class="p">)]</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="n">inserts</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">toDF</span><span class="p">(</span><span class="o">*</span><span class="n">columns</span><span class="p">)</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="n">hudi_options</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a>    <span class="s1">&#39;hoodie.table.name&#39;</span><span class="p">:</span> <span class="n">tableName</span><span class="p">,</span>
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a>    <span class="s1">&#39;hoodie.datasource.write.partitionpath.field&#39;</span><span class="p">:</span> <span class="s1">&#39;city&#39;</span><span class="p">,</span>
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a>    <span class="s1">&#39;hoodie.table.cdc.enabled&#39;</span><span class="p">:</span> <span class="s1">&#39;true&#39;</span><span class="p">,</span>
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a>    <span class="s1">&#39;hoodie.datasource.write.precombine.field&#39;</span><span class="p">:</span> <span class="s1">&#39;ts&#39;</span><span class="p">,</span>
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a>    <span class="s1">&#39;hoodie.datasource.write.recordkey.field&#39;</span><span class="p">:</span> <span class="s1">&#39;uuid&#39;</span>
</span><span id="__span-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a><span class="p">}</span>
</span><span id="__span-14-18"><a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a><span class="c1"># Insert data</span>
</span><span id="__span-14-19"><a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a><span class="n">inserts</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;hudi&quot;</span><span class="p">)</span><span class="o">.</span> \
</span><span id="__span-14-20"><a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a>    <span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">hudi_options</span><span class="p">)</span><span class="o">.</span> \
</span><span id="__span-14-21"><a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a>    <span class="n">mode</span><span class="p">(</span><span class="s2">&quot;overwrite&quot;</span><span class="p">)</span><span class="o">.</span> \
</span><span id="__span-14-22"><a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a>    <span class="n">save</span><span class="p">(</span><span class="n">basePath</span><span class="p">)</span>
</span><span id="__span-14-23"><a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a>
</span><span id="__span-14-24"><a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a>
</span><span id="__span-14-25"><a id="__codelineno-14-25" name="__codelineno-14-25" href="#__codelineno-14-25"></a><span class="c1">#  Update fare for riders: rider-A and rider-B </span>
</span><span id="__span-14-26"><a id="__codelineno-14-26" name="__codelineno-14-26" href="#__codelineno-14-26"></a><span class="n">updatesDf</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;hudi&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">basePath</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;rider == &#39;rider-A&#39; or rider == &#39;rider-B&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;fare&quot;</span><span class="p">,</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;fare&quot;</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span>
</span><span id="__span-14-27"><a id="__codelineno-14-27" name="__codelineno-14-27" href="#__codelineno-14-27"></a>
</span><span id="__span-14-28"><a id="__codelineno-14-28" name="__codelineno-14-28" href="#__codelineno-14-28"></a><span class="n">updatesDf</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;hudi&quot;</span><span class="p">)</span><span class="o">.</span> \
</span><span id="__span-14-29"><a id="__codelineno-14-29" name="__codelineno-14-29" href="#__codelineno-14-29"></a>    <span class="n">mode</span><span class="p">(</span><span class="s2">&quot;append&quot;</span><span class="p">)</span><span class="o">.</span> \
</span><span id="__span-14-30"><a id="__codelineno-14-30" name="__codelineno-14-30" href="#__codelineno-14-30"></a>    <span class="n">save</span><span class="p">(</span><span class="n">basePath</span><span class="p">)</span>
</span><span id="__span-14-31"><a id="__codelineno-14-31" name="__codelineno-14-31" href="#__codelineno-14-31"></a>
</span><span id="__span-14-32"><a id="__codelineno-14-32" name="__codelineno-14-32" href="#__codelineno-14-32"></a><span class="c1"># Query CDC data</span>
</span><span id="__span-14-33"><a id="__codelineno-14-33" name="__codelineno-14-33" href="#__codelineno-14-33"></a><span class="n">cdc_read_options</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-14-34"><a id="__codelineno-14-34" name="__codelineno-14-34" href="#__codelineno-14-34"></a>    <span class="s1">&#39;hoodie.datasource.query.incremental.format&#39;</span><span class="p">:</span> <span class="s1">&#39;cdc&#39;</span><span class="p">,</span>
</span><span id="__span-14-35"><a id="__codelineno-14-35" name="__codelineno-14-35" href="#__codelineno-14-35"></a>    <span class="s1">&#39;hoodie.datasource.query.type&#39;</span><span class="p">:</span> <span class="s1">&#39;incremental&#39;</span><span class="p">,</span>
</span><span id="__span-14-36"><a id="__codelineno-14-36" name="__codelineno-14-36" href="#__codelineno-14-36"></a>    <span class="s1">&#39;hoodie.datasource.read.begin.instanttime&#39;</span><span class="p">:</span> <span class="mi">0</span>
</span><span id="__span-14-37"><a id="__codelineno-14-37" name="__codelineno-14-37" href="#__codelineno-14-37"></a><span class="p">}</span>
</span><span id="__span-14-38"><a id="__codelineno-14-38" name="__codelineno-14-38" href="#__codelineno-14-38"></a><span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;hudi&quot;</span><span class="p">)</span><span class="o">.</span> \
</span><span id="__span-14-39"><a id="__codelineno-14-39" name="__codelineno-14-39" href="#__codelineno-14-39"></a>    <span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">cdc_read_options</span><span class="p">)</span><span class="o">.</span> \
</span><span id="__span-14-40"><a id="__codelineno-14-40" name="__codelineno-14-40" href="#__codelineno-14-40"></a>    <span class="n">load</span><span class="p">(</span><span class="n">basePath</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span></code></pre></div>
<p>Output:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>Change<span class="w"> </span>Data<span class="w"> </span>Capture<span class="w"> </span>Query
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>+---+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="p">|</span>op<span class="w"> </span><span class="p">|</span>ts_ms<span class="w">            </span><span class="p">|</span>before<span class="w">                                                                                                                                                                                                                                                                                                                                                                                                                                                         </span><span class="p">|</span>after<span class="w">                                                                                                                                                                                                                                                                                                                                                                                                                                     </span><span class="p">|</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>+---+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="p">|</span>i<span class="w">  </span><span class="p">|</span><span class="m">20240705004850080</span><span class="p">|</span>NULL<span class="w">                                                                                                                                                                                                                                                                                                                                                                                                                                                           </span><span class="p">|</span><span class="o">{</span><span class="s2">&quot;driver&quot;</span>:<span class="s2">&quot;driver-N&quot;</span>,<span class="s2">&quot;_hoodie_record_key&quot;</span>:<span class="s2">&quot;e3cf430c-889d-4015-bc98-59bdce1e530c&quot;</span>,<span class="s2">&quot;city&quot;</span>:<span class="s2">&quot;sao_paulo&quot;</span>,<span class="s2">&quot;_hoodie_partition_path&quot;</span>:<span class="s2">&quot;sao_paulo&quot;</span>,<span class="s2">&quot;_hoodie_file_name&quot;</span>:<span class="s2">&quot;1b3061be-e5df-44bb-b234-2da032806851-0_1-146-246_20240705004850080.parquet&quot;</span>,<span class="s2">&quot;_hoodie_commit_seqno&quot;</span>:<span class="s2">&quot;20240705004850080_1_0&quot;</span>,<span class="s2">&quot;fare&quot;</span>:34.15,<span class="s2">&quot;rider&quot;</span>:<span class="s2">&quot;rider-C&quot;</span>,<span class="s2">&quot;_hoodie_commit_time&quot;</span>:<span class="s2">&quot;20240705004850080&quot;</span>,<span class="s2">&quot;ts&quot;</span>:1695516137016,<span class="s2">&quot;uuid&quot;</span>:<span class="s2">&quot;e3cf430c-889d-4015-bc98-59bdce1e530c&quot;</span><span class="o">}</span><span class="w">       </span><span class="p">|</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="p">|</span>i<span class="w">  </span><span class="p">|</span><span class="m">20240705004850080</span><span class="p">|</span>NULL<span class="w">                                                                                                                                                                                                                                                                                                                                                                                                                                                           </span><span class="p">|</span><span class="o">{</span><span class="s2">&quot;driver&quot;</span>:<span class="s2">&quot;driver-M&quot;</span>,<span class="s2">&quot;_hoodie_record_key&quot;</span>:<span class="s2">&quot;9909a8b1-2d15-4d3d-8ec9-efc48c536a00&quot;</span>,<span class="s2">&quot;city&quot;</span>:<span class="s2">&quot;san_francisco&quot;</span>,<span class="s2">&quot;_hoodie_partition_path&quot;</span>:<span class="s2">&quot;san_francisco&quot;</span>,<span class="s2">&quot;_hoodie_file_name&quot;</span>:<span class="s2">&quot;69ea351b-2ce4-4590-97f0-11b4d4d3146d-0_0-146-245_20240705004850080.parquet&quot;</span>,<span class="s2">&quot;_hoodie_commit_seqno&quot;</span>:<span class="s2">&quot;20240705004850080_0_0&quot;</span>,<span class="s2">&quot;fare&quot;</span>:33.9,<span class="s2">&quot;rider&quot;</span>:<span class="s2">&quot;rider-C&quot;</span>,<span class="s2">&quot;_hoodie_commit_time&quot;</span>:<span class="s2">&quot;20240705004850080&quot;</span>,<span class="s2">&quot;ts&quot;</span>:1695046462179,<span class="s2">&quot;uuid&quot;</span>:<span class="s2">&quot;9909a8b1-2d15-4d3d-8ec9-efc48c536a00&quot;</span><span class="o">}</span><span class="p">|</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="p">|</span>i<span class="w">  </span><span class="p">|</span><span class="m">20240705004850080</span><span class="p">|</span>NULL<span class="w">                                                                                                                                                                                                                                                                                                                                                                                                                                                           </span><span class="p">|</span><span class="o">{</span><span class="s2">&quot;driver&quot;</span>:<span class="s2">&quot;driver-K&quot;</span>,<span class="s2">&quot;_hoodie_record_key&quot;</span>:<span class="s2">&quot;334e26e9-8355-45cc-97c6-c31daf0df330&quot;</span>,<span class="s2">&quot;city&quot;</span>:<span class="s2">&quot;san_francisco&quot;</span>,<span class="s2">&quot;_hoodie_partition_path&quot;</span>:<span class="s2">&quot;san_francisco&quot;</span>,<span class="s2">&quot;_hoodie_file_name&quot;</span>:<span class="s2">&quot;69ea351b-2ce4-4590-97f0-11b4d4d3146d-0_0-146-245_20240705004850080.parquet&quot;</span>,<span class="s2">&quot;_hoodie_commit_seqno&quot;</span>:<span class="s2">&quot;20240705004850080_0_1&quot;</span>,<span class="s2">&quot;fare&quot;</span>:19.1,<span class="s2">&quot;rider&quot;</span>:<span class="s2">&quot;rider-A&quot;</span>,<span class="s2">&quot;_hoodie_commit_time&quot;</span>:<span class="s2">&quot;20240705004850080&quot;</span>,<span class="s2">&quot;ts&quot;</span>:1695159649087,<span class="s2">&quot;uuid&quot;</span>:<span class="s2">&quot;334e26e9-8355-45cc-97c6-c31daf0df330&quot;</span><span class="o">}</span><span class="p">|</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="p">|</span>i<span class="w">  </span><span class="p">|</span><span class="m">20240705004850080</span><span class="p">|</span>NULL<span class="w">                                                                                                                                                                                                                                                                                                                                                                                                                                                           </span><span class="p">|</span><span class="o">{</span><span class="s2">&quot;driver&quot;</span>:<span class="s2">&quot;driver-L&quot;</span>,<span class="s2">&quot;_hoodie_record_key&quot;</span>:<span class="s2">&quot;e96c4396-3fad-413a-a942-4cb36106d721&quot;</span>,<span class="s2">&quot;city&quot;</span>:<span class="s2">&quot;san_francisco&quot;</span>,<span class="s2">&quot;_hoodie_partition_path&quot;</span>:<span class="s2">&quot;san_francisco&quot;</span>,<span class="s2">&quot;_hoodie_file_name&quot;</span>:<span class="s2">&quot;69ea351b-2ce4-4590-97f0-11b4d4d3146d-0_0-146-245_20240705004850080.parquet&quot;</span>,<span class="s2">&quot;_hoodie_commit_seqno&quot;</span>:<span class="s2">&quot;20240705004850080_0_2&quot;</span>,<span class="s2">&quot;fare&quot;</span>:27.7,<span class="s2">&quot;rider&quot;</span>:<span class="s2">&quot;rider-B&quot;</span>,<span class="s2">&quot;_hoodie_commit_time&quot;</span>:<span class="s2">&quot;20240705004850080&quot;</span>,<span class="s2">&quot;ts&quot;</span>:1695091554788,<span class="s2">&quot;uuid&quot;</span>:<span class="s2">&quot;e96c4396-3fad-413a-a942-4cb36106d721&quot;</span><span class="o">}</span><span class="p">|</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="p">|</span>u<span class="w">  </span><span class="p">|</span><span class="m">20240705004851440</span><span class="p">|</span><span class="o">{</span><span class="s2">&quot;_hoodie_commit_time&quot;</span>:<span class="w"> </span><span class="s2">&quot;20240705004850080&quot;</span>,<span class="w"> </span><span class="s2">&quot;_hoodie_commit_seqno&quot;</span>:<span class="w"> </span><span class="s2">&quot;20240705004850080_0_1&quot;</span>,<span class="w"> </span><span class="s2">&quot;_hoodie_record_key&quot;</span>:<span class="w"> </span><span class="s2">&quot;334e26e9-8355-45cc-97c6-c31daf0df330&quot;</span>,<span class="w"> </span><span class="s2">&quot;_hoodie_partition_path&quot;</span>:<span class="w"> </span><span class="s2">&quot;san_francisco&quot;</span>,<span class="w"> </span><span class="s2">&quot;_hoodie_file_name&quot;</span>:<span class="w"> </span><span class="s2">&quot;69ea351b-2ce4-4590-97f0-11b4d4d3146d-0_0-146-245_20240705004850080.parquet&quot;</span>,<span class="w"> </span><span class="s2">&quot;ts&quot;</span>:<span class="w"> </span><span class="m">1695159649087</span>,<span class="w"> </span><span class="s2">&quot;uuid&quot;</span>:<span class="w"> </span><span class="s2">&quot;334e26e9-8355-45cc-97c6-c31daf0df330&quot;</span>,<span class="w"> </span><span class="s2">&quot;rider&quot;</span>:<span class="w"> </span><span class="s2">&quot;rider-A&quot;</span>,<span class="w"> </span><span class="s2">&quot;driver&quot;</span>:<span class="w"> </span><span class="s2">&quot;driver-K&quot;</span>,<span class="w"> </span><span class="s2">&quot;fare&quot;</span>:<span class="w"> </span><span class="m">19</span>.1,<span class="w"> </span><span class="s2">&quot;city&quot;</span>:<span class="w"> </span><span class="s2">&quot;san_francisco&quot;</span><span class="o">}</span><span class="p">|</span><span class="o">{</span><span class="s2">&quot;_hoodie_commit_time&quot;</span>:<span class="w"> </span><span class="s2">&quot;20240705004851440&quot;</span>,<span class="w"> </span><span class="s2">&quot;_hoodie_commit_seqno&quot;</span>:<span class="w"> </span><span class="s2">&quot;20240705004851440_0_1&quot;</span>,<span class="w"> </span><span class="s2">&quot;_hoodie_record_key&quot;</span>:<span class="w"> </span><span class="s2">&quot;334e26e9-8355-45cc-97c6-c31daf0df330&quot;</span>,<span class="w"> </span><span class="s2">&quot;_hoodie_partition_path&quot;</span>:<span class="w"> </span><span class="s2">&quot;san_francisco&quot;</span>,<span class="w"> </span><span class="s2">&quot;_hoodie_file_name&quot;</span>:<span class="w"> </span><span class="s2">&quot;69ea351b-2ce4-4590-97f0-11b4d4d3146d-0&quot;</span>,<span class="w"> </span><span class="s2">&quot;ts&quot;</span>:<span class="w"> </span><span class="m">1695159649087</span>,<span class="w"> </span><span class="s2">&quot;uuid&quot;</span>:<span class="w"> </span><span class="s2">&quot;334e26e9-8355-45cc-97c6-c31daf0df330&quot;</span>,<span class="w"> </span><span class="s2">&quot;rider&quot;</span>:<span class="w"> </span><span class="s2">&quot;rider-A&quot;</span>,<span class="w"> </span><span class="s2">&quot;driver&quot;</span>:<span class="w"> </span><span class="s2">&quot;driver-K&quot;</span>,<span class="w"> </span><span class="s2">&quot;fare&quot;</span>:<span class="w"> </span><span class="m">191</span>.0,<span class="w"> </span><span class="s2">&quot;city&quot;</span>:<span class="w"> </span><span class="s2">&quot;san_francisco&quot;</span><span class="o">}</span><span class="w">              </span><span class="p">|</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="p">|</span>u<span class="w">  </span><span class="p">|</span><span class="m">20240705004851440</span><span class="p">|</span><span class="o">{</span><span class="s2">&quot;_hoodie_commit_time&quot;</span>:<span class="w"> </span><span class="s2">&quot;20240705004850080&quot;</span>,<span class="w"> </span><span class="s2">&quot;_hoodie_commit_seqno&quot;</span>:<span class="w"> </span><span class="s2">&quot;20240705004850080_0_2&quot;</span>,<span class="w"> </span><span class="s2">&quot;_hoodie_record_key&quot;</span>:<span class="w"> </span><span class="s2">&quot;e96c4396-3fad-413a-a942-4cb36106d721&quot;</span>,<span class="w"> </span><span class="s2">&quot;_hoodie_partition_path&quot;</span>:<span class="w"> </span><span class="s2">&quot;san_francisco&quot;</span>,<span class="w"> </span><span class="s2">&quot;_hoodie_file_name&quot;</span>:<span class="w"> </span><span class="s2">&quot;69ea351b-2ce4-4590-97f0-11b4d4d3146d-0_0-146-245_20240705004850080.parquet&quot;</span>,<span class="w"> </span><span class="s2">&quot;ts&quot;</span>:<span class="w"> </span><span class="m">1695091554788</span>,<span class="w"> </span><span class="s2">&quot;uuid&quot;</span>:<span class="w"> </span><span class="s2">&quot;e96c4396-3fad-413a-a942-4cb36106d721&quot;</span>,<span class="w"> </span><span class="s2">&quot;rider&quot;</span>:<span class="w"> </span><span class="s2">&quot;rider-B&quot;</span>,<span class="w"> </span><span class="s2">&quot;driver&quot;</span>:<span class="w"> </span><span class="s2">&quot;driver-L&quot;</span>,<span class="w"> </span><span class="s2">&quot;fare&quot;</span>:<span class="w"> </span><span class="m">27</span>.7,<span class="w"> </span><span class="s2">&quot;city&quot;</span>:<span class="w"> </span><span class="s2">&quot;san_francisco&quot;</span><span class="o">}</span><span class="p">|</span><span class="o">{</span><span class="s2">&quot;_hoodie_commit_time&quot;</span>:<span class="w"> </span><span class="s2">&quot;20240705004851440&quot;</span>,<span class="w"> </span><span class="s2">&quot;_hoodie_commit_seqno&quot;</span>:<span class="w"> </span><span class="s2">&quot;20240705004851440_0_2&quot;</span>,<span class="w"> </span><span class="s2">&quot;_hoodie_record_key&quot;</span>:<span class="w"> </span><span class="s2">&quot;e96c4396-3fad-413a-a942-4cb36106d721&quot;</span>,<span class="w"> </span><span class="s2">&quot;_hoodie_partition_path&quot;</span>:<span class="w"> </span><span class="s2">&quot;san_francisco&quot;</span>,<span class="w"> </span><span class="s2">&quot;_hoodie_file_name&quot;</span>:<span class="w"> </span><span class="s2">&quot;69ea351b-2ce4-4590-97f0-11b4d4d3146d-0&quot;</span>,<span class="w"> </span><span class="s2">&quot;ts&quot;</span>:<span class="w"> </span><span class="m">1695091554788</span>,<span class="w"> </span><span class="s2">&quot;uuid&quot;</span>:<span class="w"> </span><span class="s2">&quot;e96c4396-3fad-413a-a942-4cb36106d721&quot;</span>,<span class="w"> </span><span class="s2">&quot;rider&quot;</span>:<span class="w"> </span><span class="s2">&quot;rider-B&quot;</span>,<span class="w"> </span><span class="s2">&quot;driver&quot;</span>:<span class="w"> </span><span class="s2">&quot;driver-L&quot;</span>,<span class="w"> </span><span class="s2">&quot;fare&quot;</span>:<span class="w"> </span><span class="m">277</span>.0,<span class="w"> </span><span class="s2">&quot;city&quot;</span>:<span class="w"> </span><span class="s2">&quot;san_francisco&quot;</span><span class="o">}</span><span class="w">              </span><span class="p">|</span>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a>+---+-----------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
</span></code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Note that CDC queries are currently only supported on <code>Copy-on-Write</code> tables.</p>
</div>
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">#</a></h2>
<ul>
<li><a href="https://hudi.apache.org/docs/overview/">Apache Hudi Official Documentation</a></li>
</ul>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">July 13, 2024</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3h-2Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">July 13, 2024</span>
  </span>

    
    
    
  </aside>


  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="this page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 9v12H1V9h4m4 12a2 2 0 0 1-2-2V9c0-.55.22-1.05.59-1.41L14.17 1l1.06 1.06c.27.27.44.64.44 1.05l-.03.32L14.69 8H21a2 2 0 0 1 2 2v2c0 .26-.05.5-.14.73l-3.02 7.05C19.54 20.5 18.83 21 18 21H9m0-2h9.03L21 12v-2h-8.79l1.13-5.32L9 9.03V19Z"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 15V3h4v12h-4M15 3a2 2 0 0 1 2 2v10c0 .55-.22 1.05-.59 1.41L9.83 23l-1.06-1.06c-.27-.27-.44-.64-.44-1.06l.03-.31.95-4.57H3a2 2 0 0 1-2-2v-2c0-.26.05-.5.14-.73l3.02-7.05C4.46 3.5 5.17 3 6 3h9m0 2H5.97L3 12v2h8.78l-1.13 5.32L15 14.97V5Z"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              Thanks for your feedback! Help us improve this page by
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../delta-spark/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Delta Lake with Apache Spark">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Delta Lake with Apache Spark
              </div>
            </div>
          </a>
        
        
          
          <a href="../duckdb-quickstart/" class="md-footer__link md-footer__link--next" aria-label="Next: DuckDB Quick Start using Jupyter Notebook">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                DuckDB Quick Start using Jupyter Notebook
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Karl Christian

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/karllchris" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/karlchris" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://medium.com/@karl.christian" target="_blank" rel="noopener" title="medium.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M180.5 74.262C80.813 74.262 0 155.633 0 256s80.819 181.738 180.5 181.738S361 356.373 361 256 280.191 74.262 180.5 74.262Zm288.25 10.646c-49.845 0-90.245 76.619-90.245 171.095s40.406 171.1 90.251 171.1 90.251-76.619 90.251-171.1H559c0-94.503-40.4-171.095-90.248-171.095Zm139.506 17.821c-17.526 0-31.735 68.628-31.735 153.274s14.2 153.274 31.735 153.274S640 340.631 640 256c0-84.649-14.215-153.271-31.742-153.271Z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  


  
    
  



  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        </label>
      </li>
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.instant.preview", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.path", "navigation.indexes", "navigation.top", "navigation.footer", "toc.extend", "toc.follow", "content.code.copy", "content.code.select", "content.code.annotate", "content.tabs.link", "content.action.edit", "content.action.view", "search.suggest", "search.highlight", "search.share"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.081f42fc.min.js"></script>
      
    
  </body>
</html>